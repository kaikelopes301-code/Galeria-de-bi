expression Rel_FOR_2 =
		let
		    Fonte = Sql.Database("atlas-sql-report-production.database.windows.net", "afm-encargos-prod-bi", [Query="DECLARE @currentDate datetime2 = GETDATE();#(lf)DECLARE @organizationId uniqueidentifier = 'ed655166-232e-4710-8095-0ae504faa5eb';#(lf)DECLARE @initialDate datetime2 = '2024-01-01 00:00:00';#(lf)DECLARE @finalDate datetime2 = GETDATE();#(lf)#(lf)SELECT #(lf)#(tab)D.Name AS [Documento],#(lf)#(tab)DS.Id AS [DocumentScheduleId],#(lf)#(tab)CASE#(lf)        WHEN D.DeliveryKind = 0 THEN 'Recorrente'#(lf)        WHEN D.DeliveryKind = 1 THEN 'Mobilização'#(lf)        WHEN D.DeliveryKind = 2 THEN 'Treinamento'#(lf)        ELSE '--'#(lf)    END AS [Tipo do documento],#(lf)#(tab)C.OrderNumber AS [Numeros dos Pedidos],#(lf)#(tab)CASE#(lf)#(tab)#(tab)WHEN [c].[Type] & 1 = 1 THEN 'Contínuo'#(lf)#(tab)#(tab)WHEN [c].[Type] & 2 = 2 THEN 'Grandes Paradas'#(lf)#(tab)#(tab)WHEN [c].[Type] & 4 = 4 THEN 'Eventual'#(lf)#(tab)#(tab)WHEN [c].[Type] & 8 = 8 THEN 'Temporário'#(lf)#(tab)#(tab)WHEN [c].[Type] & 16 = 16 THEN 'Visitante técnico'#(lf)#(tab)#(tab)WHEN [c].[Type] & 32 = 32 THEN 'Prestação de Serviço de Consultor Proprietário da empresa'#(lf)#(tab)#(tab)WHEN [c].[Type] & 64 = 64 THEN 'Prestação de serviço eventual fora da área operacional'#(lf)#(tab)#(tab)WHEN [c].[Type] & 128 = 128 THEN 'Prestação de serviço de auditoria, sem acesso as áreas restritas'#(lf)#(tab)#(tab)WHEN [c].[Type] & 256 = 256 THEN 'Compra Direta, Regulariza e Delegada'#(lf)#(tab)#(tab)ELSE 'Nenhum'#(lf)#(tab)END AS [Tipos do Contrato],#(lf)#(tab)P.TradeName AS [Fornecedor],#(lf)#(tab)[bc].[CompanyName] AS [Razão Social],#(lf)#(tab)dbo.FormatCNPJ([BC].[Document]) AS [CNPJ],#(lf)#(tab)'---' AS [Funcionário],#(lf)#(tab)FORMAT([DS].[ExpectedUploadAt], 'dd/MM/yyyy') AS [Prazo de Envio],#(lf)#(tab)FORMAT([ds].[UploadedAt], 'dd/MM/yyyy') AS [Data de Envio],#(lf)    FORMAT([DS].[ValidatedAt], 'dd/MM/yyyy') AS [Data da Análise],#(lf)#(tab)CASE#(lf)        WHEN#(lf)            [ds].[ExpectedUploadAt] < @currentDate AND ([ds].[UploadedAt] IS NULL)#(lf)        THEN#(lf)            'Atrasado'#(lf)        WHEN#(lf)            [ds].[ExpectedUploadAt] >= @currentDate AND ([ds].[UploadedAt] IS NULL)#(lf)        THEN#(lf)            'Próxima Entrega'#(lf)        WHEN#(lf)            [ds].[ExpectedUploadAt] < @currentDate AND [ds].[RequiresValidation] = 1 AND ([ds].[UploadedAt] IS NOT NULL) AND ([ds].[ValidatedAt] IS NOT NULL) AND ([ds].[IsValidated] IS NOT NULL) AND [ds].[IsValidated] = 0#(lf)        THEN#(lf)            'Atrasado Recusado'#(lf)        WHEN#(lf)            [ds].[ExpectedUploadAt] >= @currentDate AND [ds].[RequiresValidation] = 1 AND ([ds].[UploadedAt] IS NOT NULL) AND ([ds].[ValidatedAt] IS NOT NULL) AND ([ds].[IsValidated] IS NOT NULL) AND [ds].[IsValidated] = 0#(lf)        THEN#(lf)            'Próxima Entrega Recusado'#(lf)        WHEN#(lf)            [ds].[UploadedAt] IS NOT NULL AND [ds].[RequiresValidation] = 1 AND [ds].[IsValidated] IS NULL#(lf)        THEN#(lf)            'Em Análise'#(lf)        WHEN#(lf)            [ds].[UploadedAt] IS NOT NULL AND [ds].[RequiresValidation] = 0#(lf)        THEN#(lf)            'Aprovado'#(lf)        WHEN#(lf)            [ds].[UploadedAt] IS NOT NULL AND [ds].[IsValidated] IS NOT NULL AND [ds].[IsValidated] = 1#(lf)        THEN#(lf)            'Aprovado'#(lf)        ELSE#(lf)            '--'#(lf)    END AS [Status],#(lf)    B.TradeName AS [Unidade(s)],#(lf)    CA.Name AS [Categoria(s)]#(lf)#(lf)FROM Contract C WITH(NOLOCK)#(lf)#(lf)#(tab)INNER JOIN DocumentSchedule DS WITH(NOLOCK)#(lf)#(tab)ON DS.ContractId = C.Id#(lf)#(lf)#(tab)INNER JOIN Document D WITH(NOLOCK)#(lf)#(tab)ON D.Id = DS.DocumentId#(lf)#(lf)#(tab)INNER JOIN Provider P WITH(NOLOCK)#(lf)#(tab)ON P.Id = C.ProviderId#(lf)#(lf)#(tab)INNER JOIN BranchCompany BC WITH(NOLOCK)#(lf)#(tab)ON BC.Id = C.BranchCompanyId#(lf)#(lf)#(tab)INNER JOIN Category CA WITH(NOLOCK)#(lf)#(tab)ON CA.Id = C.CategoryId#(lf)#(lf)#(tab)INNER JOIN Building B WITH(NOLOCK)#(lf)#(tab)ON B.Id = C.BuildingId#(lf)#(lf)WHERE#(lf)#(tab)[DS].[Removed] = CAST(0 AS bit)#(lf)    AND [D].[Removed] = CAST(0 AS bit)#(lf)    AND [D].[Archived] = CAST(0 AS bit)#(lf)    AND [DS].[ExpectedUploadAt] >= @initialDate#(lf)    AND [DS].[ExpectedUploadAt] < @finalDate#(lf)    AND [DS].[OrganizationId] = @organizationId#(lf)#(lf)ORDER BY #(lf)#(tab)D.Name,#(lf)#(tab)C.OrderNumber#(lf)#(lf)#(lf)#(lf)#(lf)"]),
		    #"Tipo Alterado" = Table.TransformColumnTypes(Fonte,{{"Documento", type text}, {"DocumentScheduleId", type text}, {"Tipo do documento", type text}, {"Numeros dos Pedidos", type any}, {"Tipos do Contrato", type text}, {"Fornecedor", type text}, {"CNPJ", type text}, {"Funcionário", type text}, {"Prazo de Envio", type date}, {"Data da Análise", type any}, {"Status", type text}, {"Unidade(s)", type text}, {"Categoria(s)", type text}})
		in
		    #"Tipo Alterado"
	lineageTag: b4e3317b-b527-4210-9dea-eca7b530269c

	annotation PBI_NavigationStepName = Navegação

	annotation PBI_ResultType = Table

expression Contratos =
		let
		    Fonte = Excel.Workbook(File.Contents("C:\Users\JoãoLima\Diretório Padrão\Atlas Inovações - Documentos\Relatórios\Dados\02. Externo\01. AFM Gestão\Votorantim Cimentos\Aderência e Conformidade\2025\03 - Março\Contratos - 2503071158.xlsx"), null, true),
		    Contratos_Sheet = Fonte{[Item="Contratos",Kind="Sheet"]}[Data],
		    #"Cabeçalhos Promovidos" = Table.PromoteHeaders(Contratos_Sheet, [PromoteAllScalars=true]),
		    #"Tipo Alterado" = Table.TransformColumnTypes(#"Cabeçalhos Promovidos",{{"Column1", type any},  {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}, {"Column14", type text}, {"Column15", type any}, {"Column16", type any}}),
		    #"Linhas em Branco Removidas" = Table.SelectRows(#"Tipo Alterado", each not List.IsEmpty(List.RemoveMatchingItems(Record.FieldValues(_), {"", null}))),
		    #"Colunas Removidas" = Table.RemoveColumns(#"Linhas em Branco Removidas",{"Column1", "Column15", "Column16"}),
		    #"Cabeçalhos Promovidos1" = Table.PromoteHeaders(#"Colunas Removidas", [PromoteAllScalars=true]),
		    #"Tipo Alterado1" = Table.TransformColumnTypes(#"Cabeçalhos Promovidos1",{{"Nº do pedido", type text}, {"Razão social", type text}, {"CNPJ", type text}, {"Tipo da contratação", type text}, {"SLA", type text}, {"Status", type text}, {"Cadastro no sistema", type datetime}, {"Vigência", type text}, {"Unidade", type text}, {"Categoria", type text}, {"Fornecedor", type text}, {"Possui dados de faturamento?", type text}, {"Possui dados de faturamento?_1", type text}})
		in
		    #"Tipo Alterado1"
	lineageTag: 70d91723-2805-49fe-9e40-7871f3fb82c9

	annotation PBI_NavigationStepName = Navegação

	annotation PBI_ResultType = Table

