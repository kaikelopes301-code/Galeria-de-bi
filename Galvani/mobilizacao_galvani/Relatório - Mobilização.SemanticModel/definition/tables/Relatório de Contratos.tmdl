table 'Relatório de Contratos'
	lineageTag: d5d98fd3-2526-4c4f-bfc3-f4730b018f1e

	measure _Contratos_ = DISTINCTCOUNT('Relatório de Contratos'[Id do Contrato])
		formatString: 0
		lineageTag: 6007065b-4557-4b44-9b2f-cf6923b41dd9

	measure 'Medida 2'
		lineageTag: 5a2298af-e621-4a43-846a-4a8dc9fdef2e

	measure _Fornecedores_ = DISTINCTCOUNT('Relatório de Contratos'[CNPJ])
		formatString: 0
		lineageTag: 8a093711-46aa-40d8-96ed-c400a65203e7

	measure _Unidades_ = DISTINCTCOUNT('Relatório de Contratos'[Unidade])
		formatString: 0
		lineageTag: 5e320442-f3b9-4cae-9387-e88d3d094253

	column 'Nº do pedido'
		dataType: string
		lineageTag: 043d7409-bc4e-400a-ad1b-5a9908ca48ed
		summarizeBy: none
		sourceColumn: Nº do pedido

		annotation SummarizationSetBy = Automatic

	column 'Id do Contrato'
		dataType: string
		lineageTag: f8f4144e-f546-44bd-9aa3-2913783b137c
		summarizeBy: none
		sourceColumn: Id do Contrato

		annotation SummarizationSetBy = Automatic

	column 'Razão social'
		dataType: string
		lineageTag: 11a8f40a-eab1-4a89-995c-9bfcec38abd5
		summarizeBy: none
		sourceColumn: Razão social

		annotation SummarizationSetBy = Automatic

	column CNPJ
		dataType: string
		lineageTag: 0b9eb200-3d92-48ae-ac4e-8bf3a27d694d
		summarizeBy: none
		sourceColumn: CNPJ

		annotation SummarizationSetBy = Automatic

	column 'Tipo da contratação'
		dataType: string
		lineageTag: e00ed8de-29c7-49f8-bb0a-9b68966f4ca0
		summarizeBy: none
		sourceColumn: Tipo da contratação

		annotation SummarizationSetBy = Automatic

	column Sla
		dataType: string
		lineageTag: 7f38dac2-fe63-4482-8041-d07b53a6abce
		summarizeBy: none
		sourceColumn: Sla

		annotation SummarizationSetBy = Automatic

	column Status
		dataType: string
		lineageTag: a6425969-d680-430b-80ea-ff4aed7513ce
		summarizeBy: none
		sourceColumn: Status

		annotation SummarizationSetBy = Automatic

	column 'Cadastro no sistema'
		dataType: dateTime
		formatString: General Date
		lineageTag: 6465ca51-5681-4cc5-8b41-457c042d26ed
		summarizeBy: none
		sourceColumn: Cadastro no sistema

		variation Variation
			isDefault
			relationship: 96a4b494-6b3f-42ec-aa9e-fbcf16dc085e
			defaultHierarchy: LocalDateTable_2a979920-7442-413f-b2ef-109de928a00f.'Hierarquia de datas'

		annotation SummarizationSetBy = Automatic

	column Vigência
		dataType: string
		lineageTag: c5f74993-e8a6-4d6b-9b00-ad10bf0f7f3e
		summarizeBy: none
		sourceColumn: Vigência

		annotation SummarizationSetBy = Automatic

	column Unidade
		dataType: string
		lineageTag: e8676b09-ddf8-4d02-8b85-133f0ba76cc8
		summarizeBy: none
		sourceColumn: Unidade

		annotation SummarizationSetBy = Automatic

	column Regional
		dataType: string
		lineageTag: 0b5a2883-7d08-43c1-a80e-7d3b4942373d
		summarizeBy: none
		sourceColumn: Regional

		annotation SummarizationSetBy = Automatic

	column Categoria
		dataType: string
		lineageTag: a50f2518-47a0-4edb-a896-610048ada59e
		summarizeBy: none
		sourceColumn: Categoria

		annotation SummarizationSetBy = Automatic

	column Fornecedor
		dataType: string
		lineageTag: 106a1447-b16e-42ac-a0b1-cc4ba413decb
		summarizeBy: none
		sourceColumn: Fornecedor

		annotation SummarizationSetBy = Automatic

	column 'Valor do contrato'
		dataType: double
		lineageTag: de38409c-e6b4-4d97-bf57-1b0847fa114e
		summarizeBy: sum
		sourceColumn: Valor do contrato

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'Nome do Gestor'
		dataType: string
		lineageTag: 78a70ffa-3992-477f-ace9-a1fab3b6c1f8
		summarizeBy: none
		sourceColumn: Nome do Gestor

		annotation SummarizationSetBy = Automatic

	column 'Email do Gestor'
		dataType: string
		lineageTag: 2577a3b0-3f97-4db2-85b7-3a6a58eecf23
		summarizeBy: none
		sourceColumn: Email do Gestor

		annotation SummarizationSetBy = Automatic

	column 'Telefone do Gestor'
		dataType: string
		lineageTag: 7e017912-767c-4128-99e5-99395488cf96
		summarizeBy: none
		sourceColumn: Telefone do Gestor

		annotation SummarizationSetBy = Automatic

	column 'Nome do Contato'
		dataType: string
		lineageTag: 320a11bb-cea8-435e-b9c0-dc452e4a0ac2
		summarizeBy: none
		sourceColumn: Nome do Contato

		annotation SummarizationSetBy = Automatic

	column 'Email do Contato'
		dataType: string
		lineageTag: 8ee52d0e-397c-4c9c-83ab-0eed99f3f77c
		summarizeBy: none
		sourceColumn: Email do Contato

		annotation SummarizationSetBy = Automatic

	column 'Telefone do Contato'
		dataType: string
		lineageTag: 4bf68097-45eb-49a1-a127-1a2b8fff4a5f
		summarizeBy: none
		sourceColumn: Telefone do Contato

		annotation SummarizationSetBy = Automatic

	column Frequência
		dataType: string
		lineageTag: 0bb26835-dcc0-4635-a2a5-9f4da396c0a8
		summarizeBy: none
		sourceColumn: Frequência

		annotation SummarizationSetBy = Automatic

	column 'VP de Execução do contrato'
		dataType: string
		lineageTag: 25622d87-bc93-4921-9e8e-9ba4832d8e78
		summarizeBy: none
		sourceColumn: VP de Execução do contrato

		annotation SummarizationSetBy = Automatic

	column 'VP Requisitante do contrato'
		dataType: string
		lineageTag: fb5ce717-67de-4758-a419-a6327fe32963
		summarizeBy: none
		sourceColumn: VP Requisitante do contrato

		annotation SummarizationSetBy = Automatic

	column 'Nome do gestor técnico'
		dataType: string
		lineageTag: d93fb08c-0bbf-4228-ac53-d6051449d40a
		summarizeBy: none
		sourceColumn: Nome do gestor técnico

		annotation SummarizationSetBy = Automatic

	column 'E-mail do gestor técnico'
		dataType: string
		lineageTag: 0083c093-5a13-4601-9ef1-fd36f616a9a9
		summarizeBy: none
		sourceColumn: E-mail do gestor técnico

		annotation SummarizationSetBy = Automatic

	column 'Nome do fiscal técnico'
		dataType: string
		lineageTag: 4acbb9b3-c258-4e84-abeb-c2c80ca828fd
		summarizeBy: none
		sourceColumn: Nome do fiscal técnico

		annotation SummarizationSetBy = Automatic

	column 'E-mail do fiscal técnico'
		dataType: string
		lineageTag: 925d1c9b-3754-4f3d-b102-bcfa125cf705
		summarizeBy: none
		sourceColumn: E-mail do fiscal técnico

		annotation SummarizationSetBy = Automatic

	column 'Nome do gestor administrativo'
		dataType: string
		lineageTag: b2843113-652f-4705-bccd-bf95b1870ace
		summarizeBy: none
		sourceColumn: Nome do gestor administrativo

		annotation SummarizationSetBy = Automatic

	column 'E-mail do gestor administrativo'
		dataType: string
		lineageTag: b069da50-2568-426d-b370-f2c8caba482f
		summarizeBy: none
		sourceColumn: E-mail do gestor administrativo

		annotation SummarizationSetBy = Automatic

	column 'Nome do SST responsável'
		dataType: string
		lineageTag: 5a83535f-a3df-4364-9b2f-9bdcd4dbbb07
		summarizeBy: none
		sourceColumn: Nome do SST responsável

		annotation SummarizationSetBy = Automatic

	column 'E-mail do SST responsável'
		dataType: string
		lineageTag: ee7926be-1dc7-4a2c-9688-4e17b9987cdf
		summarizeBy: none
		sourceColumn: E-mail do SST responsável

		annotation SummarizationSetBy = Automatic

	column 'Centro de Custo'
		dataType: string
		lineageTag: 4ac0eb87-3685-4393-9ab6-af4115a9efc1
		summarizeBy: none
		sourceColumn: Centro de Custo

		annotation SummarizationSetBy = Automatic

	partition 'Relatório de Contratos' = m
		mode: import
		source =
				let
				    Fonte = Sql.Database("atlas-sql-report-production.database.windows.net", "afm-encargos-prod-bi", [Query="select distinct #(lf)#(tab)c.OrderNumber[Nº do pedido],#(lf)#(tab)c.Id[Id do Contrato],#(lf)    bc.CompanyName[Razão social],#(lf)    [bc].[Document] AS [CNPJ],#(lf)#(tab)#(lf)    case#(lf)        when c.[Type] = 1 then 'Contínuo'#(lf)        when c.[Type] = 2 then 'Grandes Paradas'#(lf)        when c.[Type] = 4 then 'Eventual'#(lf)        when c.[Type] = 8 then 'Temporário'#(lf)        when c.[Type] = 16 then 'Visitante técnico'#(lf)        when c.[Type] = 32 then 'Prestação de Serviço de Consultor Proprietário da empresa'#(lf)        when c.[Type] = 64 then 'Prestação de serviço eventual fora da área operacional'#(lf)        when c.[Type] = 128 then 'Prestação de serviço de auditoria, sem acesso as áreas restritas'#(lf)        when c.[Type] = 256 then 'Compra Direta, Regulariza e Delegada'#(lf)    end as 'Tipo da contratação',#(lf)    case#(lf)        when c.Sla = 0 then 'Padrão'#(lf)        when c.Sla = 1 then 'Emergencial'#(lf)    end as 'Sla',#(lf)    case#(lf)        when c.[Status] = 0 then 'Regular'#(lf)        when c.[Status] = 1 then 'Aguardando dados de contatos do fornecedor'#(lf)        when c.[Status] = 2 then 'Aguardando fornecedor preencher o contrato'#(lf)        when c.[Status] = 3 then 'Arquivado'#(lf)    end as 'Status',#(lf)    c.[CreatedAt][Cadastro no sistema],#(lf)    CONCAT(convert(date, c.ValidityInitial), ' a ',convert(date, c.ValidityFinal))[Vigência], #(lf)    b.TradeName[Unidade],#(lf)#(tab)r.Name AS 'Regional',#(lf)#(tab)ca.[Name][Categoria],#(lf)    p.TradeName[Fornecedor],#(lf)    c.[Value][Valor do contrato],#(lf)#(tab)cm.[Name][Nome do Gestor],#(lf)#(tab)cm.[Email][Email do Gestor],#(lf)#(tab)cm.[Phone][Telefone do Gestor],#(lf)#(tab)cc.[Name][Nome do Contato],#(lf)#(tab)cc.[Email][Email do Contato],#(lf)#(tab)cc.[Phone][Telefone do Contato],#(lf)#(tab)cfi3.[Name][Frequência],#(lf)#(tab)cfi5.[Name][VP de Execução do contrato],#(lf)#(tab)cfi7.[Name][VP Requisitante do contrato],#(lf)#(tab)cfv10.[Value][Nome do gestor técnico],#(lf)#(tab)cfv11.[Value][E-mail do gestor técnico],#(lf)#(tab)cfv8.[Value][Nome do fiscal técnico],#(lf)#(tab)cfv9.[Value][E-mail do fiscal técnico],#(tab)#(lf)#(tab)cfv12.[Value][Nome do gestor administrativo],#(lf)#(tab)cfv13.[Value][E-mail do gestor administrativo],#(lf)#(tab)cfv14.[Value][Nome do SST responsável],#(lf)#(tab)cfv15.[Value][E-mail do SST responsável],#(lf)#(tab)cfv16.[Value][Centro de Custo]#(lf)#(lf)from [Contract] c with(nolock)#(lf)#(tab)#(tab)#(lf)#(tab)#(tab)inner join Building b with(nolock) on b.Id = c.BuildingId#(lf)#(tab)#(tab)INNER JOIN Region r WITH(NOLOCK) ON r.Id = b.RegionId#(lf)#(tab)#(tab)inner join BranchCompany bc with(Nolock) on bc.Id = c.BranchCompanyId#(lf)#(tab)#(tab)inner join [Category] ca with(Nolock) on ca.Id = c.CategoryId#(lf)#(tab)#(tab)inner join [Provider] p with(nolock) on c.ProviderId = p.Id#(lf)#(tab)#(tab)left join ContractManager cm with(nolock) on cm.ContractId = c.Id and cm.Removed = 0 #(lf)#(tab)#(tab)left join ContractContact cc with(nolock) on cc.ContractId = c.Id and cm.Removed = 0#(lf)#(tab)#(tab)left join CustomFieldValue cfv8 WITH(NOLOCK) ON cfv8.EntityId = c.Id AND cfv8.CustomFieldId = '46797071-E688-4C4D-9D1E-A43BA98C9648' -- Nome do fiscal técnico#(lf)#(tab)#(tab)left join CustomFieldValue cfv9 WITH(NOLOCK) ON cfv9.EntityId = c.Id AND cfv9.CustomFieldId = '2DA18E51-F8A5-4BDC-8553-87A17EB27A7C' -- E-mail do fiscal técnico#(lf)#(tab)#(tab)left join CustomFieldValue cfv10 WITH(NOLOCK) ON cfv10.EntityId = c.Id AND cfv10.CustomFieldId = '9C244155-B8D4-4F0B-9413-7ECBCAFCD254' -- Nome do gestor técnico#(lf)#(tab)#(tab)left join CustomFieldValue cfv11 WITH(NOLOCK) ON cfv11.EntityId = c.Id AND cfv11.CustomFieldId = '7BF74685-4491-455C-9A27-F582AEE0ECA9' -- E-mail do gestor técnico#(lf)#(tab)#(tab)left join CustomFieldValue cfv12 WITH(NOLOCK) ON cfv12.EntityId = c.Id AND cfv12.CustomFieldId = '9F3F9320-74D8-4A80-A465-21C47B1D3AB1' -- Nome do gestor administrativo#(lf)#(tab)#(tab)left join CustomFieldValue cfv13 WITH(NOLOCK) ON cfv13.EntityId = c.Id AND cfv13.CustomFieldId = '8909197F-A741-48C4-82A9-02090DAD2FAD' -- E-mail do gestor administrativo#(lf)#(tab)#(tab)left join CustomFieldValue cfv14 WITH(NOLOCK) ON cfv14.EntityId = c.Id AND cfv14.CustomFieldId = '853608BB-71D6-407D-8BF1-413B396A4992' -- Nome do SST responsável#(lf)#(tab)#(tab)left join CustomFieldValue cfv15 WITH(NOLOCK) ON cfv15.EntityId = c.Id AND cfv15.CustomFieldId = '73E86956-CFF0-4D88-940B-F0F09E78E677' -- E-mail do SST responsável#(lf)#(tab)#(tab)left join CustomFieldValue cfv16 WITH(NOLOCK) ON cfv16.EntityId = c.Id AND cfv16.CustomFieldId = 'A684A08F-8759-4429-80C0-23BBB16AF57A' -- Centro de Custo#(lf)#(tab)#(tab)outer apply #(lf)#(tab)#(tab)(#(lf)    select cfi2.[Name] from CustomFieldValue cfv2 with(nolock)#(lf)#(tab)#(tab)inner join CustomFieldItem cfi2 with(nolock) on cfv2.CustomFieldItemId = cfi2.Id#(lf)    where cfv2.EntityId = c.Id#(lf)#(tab)#(tab)and cfv2.[Value] is null#(lf)#(tab)#(tab)and cfv2.Removed = 0#(lf)#(tab)#(tab)and cfi2.Removed = 0#(lf)#(tab)#(tab)AND cfv2.CustomFieldId = '1C30677D-3F2F-4396-93DE-1DA0FD90E592' -- Frequência#(lf)#(tab)) as [cfi3]#(lf)#(tab)outer apply #(lf)#(tab)(#(lf)    select cfi4.[Name] from CustomFieldValue cfv4 with(nolock)#(lf)#(tab)#(tab)inner join CustomFieldItem cfi4 with(nolock) on cfv4.CustomFieldItemId = cfi4.Id#(lf)    where cfv4.EntityId = c.Id#(lf)#(tab)#(tab)and cfv4.[Value] is null#(lf)#(tab)#(tab)and cfv4.Removed = 0#(lf)#(tab)#(tab)and cfi4.Removed = 0#(lf)#(tab)#(tab)AND cfv4.CustomFieldId = '586D0602-B8D0-480F-8565-5A1040393B54' -- VP de Execução do contrato#(lf)#(tab)) as [cfi5]#(lf)#(tab)outer apply #(lf)#(tab)(#(lf)    select cfi6.[Name] from CustomFieldValue cfv6 with(nolock)#(lf)#(tab)#(tab)inner join CustomFieldItem cfi6 with(nolock) on cfv6.CustomFieldItemId = cfi6.Id#(lf)    where cfv6.EntityId = c.Id#(lf)#(tab)#(tab)and cfv6.[Value] is null#(lf)#(tab)#(tab)and cfv6.Removed = 0#(lf)#(tab)#(tab)and cfi6.Removed = 0#(lf)#(tab)#(tab)AND cfv6.CustomFieldId = 'A53C1F6C-9334-4AF9-8B78-03CC327FB6D7' -- VP Requisitante do contrato#(lf)#(tab)) as [cfi7]#(lf)where b.OrganizationId = 'D04CA036-BA05-4B37-965E-46AB4A672C01'#(lf)#(lf)#(lf)#(lf)#(lf)#(lf)#(lf)#(lf)#(lf)#(lf)#(lf)#(lf)#(lf)#(lf)#(tab)  and c.Removed = 0#(lf)#(tab)  and cc.Removed = 0#(lf)#(tab)  and cm.Removed = 0#(lf)#(tab)  order by c.OrderNumber #(lf)#(lf)#(lf)#(tab) -- Select * from CustomField Where OrganizationId = 'e9654655-6595-4748-991d-6b50831c6ca5'#(lf)#(lf)#(lf)#(lf)#(lf)#(tab)"])
				in
				    Fonte

	annotation PBI_NavigationStepName = Navegação

	annotation PBI_ResultType = Table

